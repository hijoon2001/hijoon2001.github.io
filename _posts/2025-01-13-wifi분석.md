---
layout: posts
title: "Wifi 분석"
categories:
  - wifi
tags:
  - content
  - IPv4
  - IPv6
---

### LAN (Local Area Network) 근거리 통신망 
라우터 및 스위치와 같은 커넥터를 사용하여 물리적으로 서로 가까운 디바이스를 연결한다. 이를 통해 디바이스는 데이터를 교환하고 소규모로 안전하게 통신할 수 있다. 

### WAN (World Area Network) 광역 네트워크 
하나의 건물이나 대규모 캠퍼스를 넘어 특정 지역이나 심지어 전 세계에 분산된 여러 위치까지도 포함..! 

#### 둘의 유사점? 
LAN 과 WAN 은 네트워크 사용자가 데이터와 리소스를 공유할 수 있도록 컴퓨터와 주변 디바이스를 연결한다. 
1. **기본원리**. LAN과 WAN 모두 노드와 링크로 구성된 컴퓨터 네트워크이다. 컴퓨터 네트워크를 만들려면 두 개 이상의 드노가 필요하다. 네트워크 노드는 데이터 통신 장비(DCE) 또는 데이터 단말 장비(DTE) 일 수 있다. DCE 에는 모뎀, 허브, 스위치 등이 포함되지만 DTE 는 두 대 이상의 컴퓨터와 프린터 등일 수 있다. 링크는 두 노드를 연결하는 전송매체이다. 유선 연결은 동축, 광섬유 또는 트위스트 페어 기술로 만들어진 이더넷 케이블을 사용한다. 반면 무선 연결은 3G, 5G 기술과 같은 전파를 사용하여 노트를 연결한다. 
2. **데이터 전송**. LAN 과 WAN 모두 **DCE 네트워크 디바이스**를 사용한다. 이러한 디바이스는 네트워크가 드래픽을 전달하고 데이터를 올바른 대상으로 전송하는 데 도움이 된다. 또한 LAN과 WAN 모두 통신 프로토콜이라는 규칙 세트를 사용하여 연결된 디바이스 간의 데이터 전송을 관리한다. 가장 일반적인 프로토콜은 **TCP/IP**이다. 다양한 유형의 통신을 위한 사용자 데이터그램 프로토콜(UDP) 및 인터넷 통제 메시지 프로토콜 (ICMP) 등/의 다른 프로토콜도 있다. 
   * **TCP?** 클라이언트와 서버간에 데이터를 신뢰성있게 전달하기 위해 만들어진 프로토콜이야. 
   * **IP?** 네트워크 상에서 각 컴퓨터는 고유한 주소가 있어. 이 주소를 IP라고 하는데, 인터넷에 접속할 때 컴퓨터에 주여져. 이 주소는 총 4바이트로 이루어져 있어. 인터넷에서 하는 모든 활동에 내 IP주소가 발자국처럼 찍히는거지..   
3. **보안**. 방화벽, 암호화 및 액세스 제어와 같은 다양한 방법을 사용하여 LAN 과 WAN 을 모두 보호할 수 있다. 보안 조치는 네트워크에 대한 무단 액세스를 방지하고 전송 중 민감한데이터를 보호한다. 강력한 보안 조치를 구현하면 WAN 과 LAN 모두 사용자가 통신하고 데이터를 공유할 수 있는 안전한 환경을 제공할 수 있다.   

#### 둘의 차이점?

WAN은 여러 개의 상호 연결된 LAN 구성될 수 있어. 
1. **구성요소**       
OSI(Open Sysems Interconnection) 모델은 컴퓨터가 네트워크에서 데이터를 교환하는 방식의 계층 구조를 정의한다. 계층은 네트워크 통신의 여러 단계와 네트워크 구성요소가 교환을 위해 수행하는 다양한 작업을 식별한다.   
* LAN 은 OSI 계층 1, 2의 DCE(데이터 통신 장비)를 사용해.   
  허브 및 중계기와 같은 계층 1 디바이스는 네트워크를 통해 물리적으로 데이터를 전송해. 예를 들면 물리적 매체를 토애 전송하기 위해 디지털 신호를 아날날로그 신호로 변환 할 수 있어.       
  스위치 및 브리지와 같은 계층 2 디바이스는 동일한 네트워크 세그먼트에 있는 디바이스 간의 통신을 설정하고 유지해.     
* WAN은 OSI 계층 1, 2, 3의 DCE를 사용해.       
  계층 3 디바이스는 서로 다른 네트워크 세그먼트 간에 데이터를 라우팅해. 이를 위해 수신 데이터 패킷의 주소를 검사하고 패킷을 적절한 대상 네트워크로 전달해. 예를 들면, 다중 계층 스위치, 라우터 및 기술별 디바이스(프레임 릴레이 스위치, 비동기 전송모드(ATM)) 가 있어.  
2. **연결**
LAN 에서 디바이스 간 연결은 이더넷 케이블 또는 무선 액세스 포인트 등을 통한 물리적 연결이다. 이러한 연결을 통해 좁은 지역 내에서 디바이스 간의 빠른 통신이 가능하다.     

반대로 WAN 연결은 퍼블릭 인터넷을 통한 가상연결인 경우가 많다. 다양한 통신링크는 더 넓은 지역에 걸쳐 디바이스를 연결하는데 사용된다. 
* 임대 회선은 두 위치 간에 전영 지점 간 연결을 제공해. 원격 영역으로 고속 데이터를 전송하는데 임대회선이 사용되는 경우가 많아. 
* MPLS(멀티프로토콜 레이블 스위칭)는 레이블을 사용하여 WAN을 통해 서로 다른 위치 간에 데이터를 전달하는 라우팅 기술이야. 
* 가상 프라이빗 네트워크(VPN) 연결을 사용해 퍼블릭 네트워크를 통해 데이터를 익명으로 안전하게 전송할 수 있어.  
* 클라우드 기반 연결은 클라우드에서 호스팅 되는 리소스를 함께 연결해. 
  
3. **속도** 
LAN 은 WAN 에 비해 전파 지연이 적고 데이터 전송 속도가 높아.    
전파 지연은 신호가 네트어크의 한 지점에서 다른 지점으로 이동하는 데 걸리는 시간을 나타내. LAN 디바이스는 근접 배치되며 이더넷 케이블을 사용하여 라우터 또는 스위치를 통해 연결돼. 또한 LAN은 WAN보다 제한된 수의 사용자를 지원하기 때문에 정체가 적어. 

이에 비해 WAN은 전파 지연이 길고 데이터 전송 속도가 느려. 지리적 거리는 속도에 영향을 미치는 중요한 요소야. 또한 많은 유형의 WAN 연결은 퍼블릭 인터넷 인프라를 기반으로 하며 인터넷 작동 방식과 관련된 정체, 오류 및 지연을 경험해. 사설 임대 회선은 더 빠른 속도를 제공할 수 있지만 설치비용이 많이 들어.   

#### 각기 다른 사용사례 예시 
1. LAN
LAN을 사용하여 근접한 디바이스 간에 고속의 격리된 프라이빗 연결을 생성할 수 있다. 
* 동일한 지리적 위치(ex. 단일 사무실/ 같은 건물에 있는 여러 사무실) 내에서 파일 교환 및 통신
* 공장 내 중앙 제어 메커니즘에 자동화된 로봇 연결 
* 소매점 내 모바일 판매 시점(POS) 시스템 및 비디오 감시 디바이스를 위한 네트워크 구축  
* 데이터를 클라우드로 전송하기 전에 필터링하는 중앙 허브에 여러 IoT 센서 및 측정기 연결
2. WAN
광범위한 지역에 걸쳐 사용자와 애플리케이션을 안전하게 연결할 수 있어. 


----

## <span style="color:red">IPv4</span> vs IPv6

인터넷에 연결된 각 장치에는 정보를 주고받을 수 있는 주소가 필요해. IPv4는 현재 IP 주소를 생성, 할당 및 사용하기 위한 프로토콜이야. 처음으로 널리 보급된 IP 주소 버전은 IPV4 였어. 이 인터넷 프로토콜은 32비트 숫자 주소를 사용하니까 약 43억개의 고유 IP 주소를 가질 수 있었지.  이제는 부족해.. 그래서 새로운 버전의 인터넷 프로토콜인 IPv6이 등장하게 된거야.    

### <span style="color:red">IPv4</span> (인터넷 프로토콜 버전4) 란?
IPv4 주소는 일반적으로 192.168.0.1과 같이 마침표로 구분된 4개의 숫자가 0에서 255까지 이어지는 '점으로 구분된 10진수 표기법' 이라는 형식으로 표시돼. 이 숫자 체계는 사람이 주소를 쉽게 해석하고 관리할 수 있도록 해줘.    

### IPv6 ? 
90년대에 거의 3.4×10^8개의 고유 주소를 제공하는 128비트 IP 주소 업그레이드가 발명되었는데 이를 IPv6 라고 해.     
* 장점
    IPv6는 128비트 기술을 사용하며 340억 개의 IP 주소를 제공할 수 있어. 
    새로운 디바이스에서 지원되는 새로운 최첨단 프로토콜이야. 
    서브넷 문제가 없어. 
* 단점  
    IPv6는 구성하기가 더 어렵기 때문에 구현 중에 허점과 오류가 발생할 가능성이 커. 
    모든 웹사이트에서 지원되지 않아.
    주소가 매우 길고 기억하기 어려워. 
    인터넷의 약 1/3만이 IPv6 주소를 지원하므로 IPv6만 사용하면 일부 접근성 문제가 발생할 수 있어. 

### IPv4 vs IPv6: 속도 비교
IPv6도 IPv4보다 빠를까? 현재로서는 명확한 답이 없으며  IPv6가 광범위하게 채택될 때까지는 답이 없을 수도 있어. 성능의 차이로 볼 때 IPv4가 약간 우위에 있지만, 그 차이는 매우 작아... 

---

### WLAN(Wireless LAN, 무선랜)란? 
Wi-Fi라는 마케팅 네임으로 흔히 알려져 있어. 무선(Wirelss) 방식으로 유선랜과 같은 뛰어난 품질(Fidelity)를 제공한다는 뜻이지..      
무선 신호 전달 방식을 이용해 두 대 이상의 장치를 연결하는 무선 데이터 통신기술이야.      
**IEEE 802.11**은 무선랜을 위한 기술적 표준이고 와이파이는 이 표준을 바탕으로 개발된 무선랜 제품들에 대한 와이파이 얼라이언스(Wi-Fi Alliance)라는 단체의 상표명이야. 그러나 앞에서 말한 것처럼 통상적으로 같은 의미로 사용하고 있으므로 와이파이를를 IEEE 802.11 표준을 같은 의미로 사용할 수 있어. 

와이파이와 관련된 표준의 첫 번째 버전은 1997년에 발표되었으며, 최고 2Mbps의 통신 속도를 제공했어. 이후 1999년 9월에는 최대 11Mbps의 속도를 제공하는 802.11b 표준과 최대 54Mbps의 속도를 제공하는 IEEE 802.11a 표준이 발표되었어. 이후 와이파이를 지원하는 장치들의 보급이 활성화 되고 유튜브와 같은 동영상 서비스의 보급이 퍼지면서 더 빠른 속도의 와이파이 표준이 요구되기 시작했지. 이러한 요구에 대응하여 발표된 표준이 IEE 802.11n 표준으로 최고 150Mbps의 통신속도를 제공해. 

| 표준        | 주파수 대역      | 전송 방식 | 안테나 기술        | 채널 대역폭           | 최대 전송률     |
|-------------|------------------|-----------|--------------------|-----------------------|----------------|
| 802.11 b    | 2.4GHz          | DSSS      | SISO               | 20MHz                | 11Mbps         |
| 802.11 a/g  | 5GHz (11a)      | OFDM      | SISO               | 20MHz                | 54Mbps         |
|             | 2.4GHz (11g)    |           |                    |                       |                |
| 802.11 n    | 2.4 / 5GHz      | OFDM      | MIMO (up to 4 streams) | 20/40MHz            | 600Mbps        |
| 802.11 ac   | 5GHz            | OFDM      | MU-MIMO (up to 8 streams) | 20/40/80/160MHz    | 6.9Gbps        |

Wi-Fi 6 (=802.11ax, AX Wi-Fi): 현재의 802.11ac Wi-Fi 표준에서 더 향상되었어. 


#### 주파수 대역 및 간섭 
와이파이는 ISM 대역 (Industrial Scientific and Medical Band)으로 지정된 **2.4GHz** 대역과 **5GHz** 대역의 주파수를 이용해. 이 주파수 대역은 산업, 과학, 의료용 기기들을 위해 할당된 주파수 대역으로, 기본적인 규칙만 준수한다면 이동통신처럼 해당 주파수 대역을 이용하기 위해 별도의 이용료를 내거나 하지 않아도 되지.    
국내의 경우, 2.4GHz 대역에서는 83MHz의 주파수 대역이 할당되어 이용되는데, 83MHz의 주파수 대역에서 20MHz의 대역폭을 갖는 13개의 채널을 할당하여 이용하고 있어. 같은 채널에서 여러 대의 와이파이 장치가 사용되거나 혹은 와이파이 장치들이 인접한 채널을 이용하는 경우, 서로 다른 장치들이 통신하는 과정에서 충돌이 발생할 수 있게 되는데 이를 간섭(Interference)이라고 해.    

![image](https://github.com/user-attachments/assets/f2a6843b-c13d-492a-8958-7ae1de2706c1)

이러한 간섭 문제를 해결 하기 위해 서로 1, 6, 13번 채널이나 혹은 1, 5, 9, 13번 채널처럼 서로 중첩되지 않는 채널들을 이용하도록 권장하고 있어. 그런데도 와이파이를 이용하는 장치들이 늘어나는 속도를 감당하지 못해서, 최근에는 비중첩 채널이 20개 이상인 5GHz 대역에서 사용할 수 있는 IEEE 802.11g, IEEE 802.11n  등과 같은 표준들의 이용이 늘고 있어. 그 외에도 IEEE 802.11ac와 같은 표준은 최대 6.9Gbps 의 속도까지 제공해....            

**QAM(Quadrature Amplitude Modulation;직교 진폭 변조)?**  



### 인터넷 속도의 개념 알아보기 

#### Mbps (Megabit per second) 
인터넷 연결의 데이터 전송 속도를 나타내는 단위.   
'Mega'는 백만(million)을 의미하고, 'bit'는 데이터의 기본 단위를 의미해.. 즉 **Mbps는 1초당 몇 백만 비트의 데이터를 전송할 수 있는지**를 나타내는거지.                

1Byte = 8bit 이므로 

통신속도에 있어서 100Mbps 는 초당 12.5 MB 를 전송한다는 것을 의미한다. 이는 얼마나 빠른 전송속도를 가질지 알아보기 위해 이 속도로 3GB 영화를 다운로드 한다고 가정해보자.     

저장용량 1GB = 1024MB 이므로 3GB=1024*3MB이다. 
3072MB / 12.5MB == 246초 (4분) 만에 3GB 영화를 모두 다운로드 할 수 있다는 것을 알 수 있다.              

1G = 1024/8Mbps = 초당 128MB   
5G = 1024*5/8Mbps = 초당 640MB    
10G = 1024*10/8Mbps = 초당 1280MB
임을 알 수 있다.

8Mbps = 1MBps, 즉 11Mbps == 1.3MBps 정도..? 

#### 무선 AP(Access Point)
무선 인터넷에 접속(Acess)하기 위한 지점(Point). 유선랜의 마지막에 위치하여 무선랜과 유선랜의 연결을 중계해주는 장치를 말해. 흔히 무선 **공유기**라고 말하는 장비가 무선 AP에 해당하는거지...         
중요한 장비고, 무선 단말기의 접속에 필요한 관련 설정값을 가져. 
   * 대규모 네트워크용 AP
   * 소규모 네트워크용 AP 


## 무선랜 보안 
: 무선 주파수를 사용, 일정 공간 내 단말기 등을 무선으로 네트워크에 접속할 수 있도록 안전한 통신을 구현하는 기술.        

### 무선랜 보안 기술 유형. 

| 보안 기술 유형           | 보안 기술                                                  |
|-----------------------|---------------------------------------------------------|
| **무선랜 접속인증 기술** | - SSID 숨김 설정을 통한 접속 제한<br>- MAC 주소 인증 (MAC 주소 필터링)<br>- 공유키 인증 (PSK : Pre-Shared Key)<br>- IEEE 802.1x/EAP (인증 서버 이용) |
| **무선전송 데이터 암호 기술** | - WEP (Wired Equivalent Privacy)<br>- WPA1, 2 (Wi-Fi Protected Access)          |
     
 
| 암호화 프로토콜 | 설명                           | 특징                                      |
|-----------------|------------------------------|-----------------------------------------|
| WEP             | Wired Equivalent Privacy | - 초기 무선 보안 프로토콜로, 약한 보안성을 가짐<br>- 고안된 키 스트림이 반복되어 취약점 노출<br>- 현재 보안 표준으로 사용되지 않음 |
| WPA             | Wi-Fi Protected Access   | - WEP의 취약점을 보완하기 위해 도입됨<br>- TKIP(Temporal Key Integrity Protocol) 사용<br>- 개선된 인증 및 데이터 암호화 제공 |
| WPA2            | Wi-Fi Protected Access 2 | - 보안 강화를 위해 AES 사용<br>- CCMP 사용<br>- 안전한 보안 표준                 |
| WPA3            | Wi-Fi Protected Access 3 | - 최신 무선 보안 표준<br>- 개선된 인증 및 키 교환 프로세스 제공<br>- 강력한 보안 기능 제공  |

![image](https://github.com/user-attachments/assets/187b3461-2ae3-43db-ad49-3f98facea964)

### 무선 암호화 방식 
#### 1. WEP	(Wired Equivalent Privacy)

현대에서는 사용 잘 안해용 

유선랜과 동등한 수준의 보안성 제공을 목적으로 만든 초기 무선랜 보안 기술(802.11b 표준부터 적용)
* 데이터 암호화 : 키(고정된 공유키 + 무작위 생성 초기 벡터 (IV : Initial Vector))를 이용한 RC4알고리즘 기반. (RC4알고리즘의 자체 취약점 존재. )    
* 사용자 인증 : 공유키 인증 방식(상호 동일한 공유키를 갖는 사용자들은 정상 사용자로 인증한다.) (WEP 공유키가 쉽게 추출되는 취약점 존재. )

1) WEP 데이터 암호화 동작 방식

![image_enhanced](https://github.com/user-attachments/assets/b38ca99d-13b3-4e6f-94b4-f9af3e52d5f6)

1. 무작위로 생성하는 24bit 초기백터(IV) + 고정된 40bit(WEP-40) 또는 104bit (WEP-104)의 공유키를 조합하여 WEP 암호키 생성.   
2. PRNG (Pseudo Random Number Generator : RC4 암호 알고리즘 기반 난수 발생기)에 해당 정보를 입력하여 Key Stream 생성
3. CRC-32 알고리즘을 이용하여 무결성 체크값(ICV : Intergrity Check Value)을 생성한 후 평문과 조합  
4. Key Stream과 평문+ICV 값을 XOR하여 암호문을 생성
5. 생성된 암호문에 IV와 802.11 표준에서 사용하는 헤더를 추가하여 최종 패킷 생성

2) WEP 데이터 복호화 동작방식

1. 암호화된 패킷에서 IV(평문)을 추출 후 자신이 갖고 있는 WEP 공유키와 조합하여 PRNG를 통해 Key Stream을 생성
2. 암호문과 키스트림을 XOR하여 평문과 ICV를 생성
3. 복호화된 평문에서 CRC-32 알고리즘으로 ICV'를 구한 후 복호화된 ICV와 비교하여 패킷의 무결성 여부 검사
4. 무결성 이상 없을 시, 평문 데이터 최종 수신

3) WEP 암/복호화 문제점
- IV가 무작위 생성이긴 하나, 24bit로 짧아, 재사용 될 가능성 존재해. 
  - IV 재사용으로 인해 동일 키 스트림으로 암호화된 암호문들이 존재할 수 있고고, 어느 한 암호문의 평문을 안다면 굳이 Key가 없어도 평문을 알고 있는 암호문을 통해 복호화가 가능해. 
    - ex) 2개의 평문(P1, P2)에 대한 동일 키스트림(KS)를 이용한 암호문(C1, C2)가 생성되었다고 가정.(여기서 + 는 XOR 연산으로 가정)
    - C1 + C2 = (P1 + KS) + (P2 + KS) = P1 + P2
    - 단, 공격자가 평문 P1을 알고 있다면, C1 + C2 + P1 = P2 로, 암호문 P2를 Key없이 복호화가 가능
  - RC4 암호 알고리즘의 키 스케줄링 알고리즘과 IV 사용법의 취약점으로 인해, 암호키 노출 문제점 존재해. 
  - 짧은 길이의 고정 암호키에 의한 취약성

4) WEP 인증 절차 

![image](https://github.com/user-attachments/assets/1ed31b26-f15c-411c-b9bc-94bfd605a0db)

1. 클라이언트가 연결 요청 메세지 전송 
2. AP가 임의 문장 인증용 문자열 (= challenge) 생성, 원본을 저장한 후 challenge 사본을  전송. 
3. 요청자는 challenge값과 자신의 WEP 공유키를 이용하여 암호화 후 무선 AP에 전송. 
4. 무선 AP는 자신의 공유키를 이용하여 복호화 후, 원본과 사본 challenge 값을 비교 후, 동일 할 시 이용자로 인증해.      

5) WEP 인증 문제점 
- 사용자 인증 시, 단방향 인증방식으로 인해, Rogue AP 인지 구분 할 수 없다. 
- 무선 랜의 모든 장비가 동일한 WEP 공유키를 사용하여 유출의 위험 및, 이 문제로 공유키 주기적 변경시 관리의 어려움이 발생할 수 있다.      

#### WPA/WPA2 (Wi-fi Protection Access)
: 안전한 무선랜의 운영을 위해서는 WEP의 사용보다는 WPA/WPA2를 사용하되 가능한 긴 길이의 비밀키를 설정하거나, 추가적인 인증 서버의 운영이 필요해.   

| 802.11i 표준 | WPA (또는 WPA1)                              | WPA 2                                      |
|--------------|---------------------------------------------|-------------------------------------------|
| **암호 방식** | RC4-TKIP <br> (Temporal Key Integrity Protocol)| AES-CCMP <br>  (Counter mode with CBC-MAC Protocol)|
| **인증 방식** | 개인(Personal)                              | PSK (Pre-Shared Key) 모드                 |
|              | 기업(Enterprise)                            | 802.1x/EAP (Extensible Authentication Protocol) 모드 |

**1. TKIP(Temporal Key Integrity Protocol)**      
생성된 목적은 WEP의 강도를 향상시키거나 하드웨어 교체 없이 WEP를 완전히 대체하는 것이었어.      

기존 WEP의 암호화 알고리즘인 RC4를 사용하면서도 RC4의 보안상의 문제점을 개선하기 위해 **Key Mixing 함수, Dynamic WEP Key(Temporal Key),** 메시지 무결성 보장을 위한 **스펙(spec)**을 정의한 통신 규약이야. 

절차:
   1.  임시키, 전송 주소(송신 시 경유하는 AP의 MAC 주소), TKIP Sequence Conuter(TSC)를 입력으로 1단계 키 믹싱 함수를 통해 **TTAK 생성**
   2.  TTAK + TSC로 2단계 키 믹싱 함수를 통해 WEP 암호키 생성해. 
   3.  전송(평문) 데이터에 MIC Key, 출발지, 목적지 주소를 이용하여 MIC 값 생성해.
   4. 전송(평문) 데이터에 MIC 값 추가 후, TSC와 Fragment하여 전송용 평문을 생성해. 
   5. WEP 암호키와 전송용 평문으로 WEP 암호화 적용, 암호문을 생성해. 

**2. AES-CCMP(Counter mode with Cipher Block Chaining Message Authentication Code Protocol)**       





## SSID(Service Set Identifier)란? 
WLAN(무선 근거리 통신망)에 할당된 고유한 이름 또는 식별자. 서로 다른 무선 네트워크를 구별하고 사용자가 장치를 적절한 네트워크에 연결 할 수 있도록 하는데 사용된다.  
장치에서 사용 가능한 wifi 네트워크를 검색할 때 표시되는 네트워크 이름 목록은 해당 네트워크의 SSID이야.  
